<mvc:View xmlns:mvc="sap.ui.core.mvc"
  controllerName="veronchi.leverx.project.controller.ProductPage"
  xmlns="sap.uxap"
  xmlns:layout="sap.ui.layout"
  xmlns:tnt="sap.tnt"
  xmlns:m="sap.m"
  xmlns:f="sap.ui.layout.form"
  xmlns:core="sap.ui.core"
>
  <ObjectPageLayout id="ProductPage"
    showTitleInHeaderContent="true"
    showEditHeaderButton="false"
    upperCaseAnchorBar="false"
    showFooter="{editModel>/isEditMode}"
    showHeaderContent="{= !${editModel>/isProductCreate}}"
    >
    <headerTitle>
      <ObjectPageDynamicHeaderTitle>
        <heading>
          <m:HBox>
            <m:Title
              text="{= !${editModel>/isProductCreate} ? ${appModel>name} : ${i18n>CreateProductTitle}}"
              wrapping="true"
              class="sapUiTinyMarginEnd"
            />
          </m:HBox>
        </heading>
        <expandedContent>
          <m:Text text="{appModel>description}" visible="{= !${editModel>/isProductCreate}}" />
        </expandedContent>
        <actions>
          <m:Button
            text="{i18n>EditButtonText}"
            type="Emphasized"
            press="onProductEdit"
            enabled="{= !${editModel>/isEditMode}}"
            visible="{= !${editModel>/isProductCreate}}"
          />
          <m:Button
            type="Transparent"
            text="{i18n>DeleteButtonText}"
            press="onProductDelete(${$source>/})" 
            enabled="{= !${editModel>/isEditMode}}"
            visible="{= !${editModel>/isProductCreate}}"
          />
        </actions>
      </ObjectPageDynamicHeaderTitle>
    </headerTitle>

    <headerContent>
      <m:FlexBox wrap="Wrap">
        <layout:VerticalLayout>
          <m:HBox visible="{= !${editModel>/isProductCreate}}">
            <m:ObjectStatus
              text="{i18n>SaleText}"
              inverted="true"
              state="Success"
              visible="{= !!${appModel>discountDate}}"
              class="sapUiSmallMarginEnd"
            />
            <tnt:InfoLabel
              text="{i18n>NewText}"
              renderMode="Narrow"
              colorScheme="1"
              class="sapUiSmallMarginEnd"
              visible="{
                path: 'appModel>releaseDate',
                formatter: '.formatter.checkIfNewProduct'
              }"
            />
          </m:HBox>
        </layout:VerticalLayout>
        <layout:VerticalLayout class="sapUiSmallMarginEnd">
          <m:HBox visible="{= !${editModel>/isProductCreate}}">
            <m:Label
              text="{i18n>TotalTimeText}"
              showColon="true"
              labelFor="totalTime"
              design="Bold"
              vAlign="Middle"
              class="sapUiTinyMarginEnd"
            />
            <m:Text
              id="totalTime"
              text="{
                path: 'appModel>releaseDate',
                formatter: '.formatter.getDaysFromReleaseDate'
              }"
            />
          </m:HBox>
        </layout:VerticalLayout>
        <layout:VerticalLayout>
          <m:HBox visible="{= !${editModel>/isProductCreate}}">
            <m:Label
              text="{i18n>ProductColumnPrice}"
              showColon="true"
              labelFor="price"
              design="Bold"
              class="sapUiTinyMarginEnd"
              vAlign="Middle"
            />
            <m:Text
              id="price"
              text="{
              parts: ['appModel>price', 'appModel>currencyCode'],
              type: 'sap.ui.model.type.Currency',
              formatOptions: {
                currencyCode : false,
                decimals: 0
              }
            }" />
          </m:HBox>
        </layout:VerticalLayout>
      </m:FlexBox>
    </headerContent>
    <sections>
      <ObjectPageSection titleUppercase="false" title="{i18n>ProductDetails}">
        <subSections>
          <ObjectPageSubSection>
            <blocks>
              <core:Fragment
                fragmentName="veronchi.leverx.project.view.fragments.ProductDetails"
                type="XML" />
            </blocks>
          </ObjectPageSubSection>
        </subSections>
      </ObjectPageSection>
      <ObjectPageSection titleUppercase="false" title="{i18n>SuppliersInfo}">
        <subSections>
          <ObjectPageSubSection>
            <blocks>
              <core:Fragment
                fragmentName="veronchi.leverx.project.view.fragments.Suppliers"
                type="XML"
              />
            </blocks>
          </ObjectPageSubSection>
        </subSections>
      </ObjectPageSection>
      <ObjectPageSection titleUppercase="false" title="{i18n>Comments}">
        <subSections>
          <ObjectPageSubSection>
            <blocks>
              <core:Fragment
                fragmentName="veronchi.leverx.project.view.fragments.Comments"
                type="XML"
              />
            </blocks>
          </ObjectPageSubSection>
        </subSections>
      </ObjectPageSection>
    </sections>
    <footer>
      <m:OverflowToolbar>
        <m:Button id="messagePopoverBtn"
					visible="{= !!${message>/}.length}"
          text="{= ${message>/}.length}"
					icon="sap-icon://error"
					type="Negative"
					press="onMessagePopoverPress(${$source>/})"
					ariaHasPopup="Dialog"
        />
        <m:ToolbarSpacer />
        <m:Button text="{i18n>SaveText}" type="Emphasized" enabled="{= !${message>/}.length}" press="onProductSave" />
        <m:Button text="{i18n>CancelText}" press="onProductCancel" />
      </m:OverflowToolbar>
    </footer>
  </ObjectPageLayout>
</mvc:View>