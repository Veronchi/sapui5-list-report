<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core">
  <Table
    id="suppliersTable"
    items="{suppliersModel>/suppliers}"
    updateFinished="filterSuppliers"
    mode="{= ${editModel>/isEditMode} ? 'Delete' : 'None'}"
    delete="onDeleteSupplierPress"
  >
    <headerToolbar>
      <OverflowToolbar>
        <Title text="{i18n>Suppliers}" level="H2" />
        <ToolbarSpacer />
        <Button
          visible="{= ${editModel>/isEditMode}}"
          type="Transparent"
          icon="sap-icon://add"
          press="onAddSupplier"
          enabled="{= !${editModel>/isSuppliersChange}}"
        />
      </OverflowToolbar>
    </headerToolbar>
    <columns>
      <Column >
        <Text text="{i18n>SupplierNameText}" />
      </Column>
      <Column>
        <Text text="{i18n>SupplierCountryText}" />
      </Column>
      <Column >
        <Text text="{i18n>SupplierStateText}" />
      </Column>
      <Column >
        <Text text="{i18n>SupplierCityText}" />
      </Column>
      <Column >
        <Text text="{i18n>SupplierStreetText}" />
      </Column>
      <Column hAlign="Center">
        <Text text="{i18n>SupplierZipCodeText}" />
      </Column>
    </columns>
    <items>
      <ColumnListItem vAlign="Middle">
        <cells>
          <VBox>
            <Text text="{suppliersModel>name}" visible="{= ${suppliersModel>id} !== '0'}" />
            <Input
              fieldGroupIds="validateInput"
              change="_validateInputControl(${$source>/})"
              required="true"
              visible="{= ${editModel>/isEditMode} &amp;&amp; ${suppliersModel>id} === '0'}"
              value="{
                path: 'suppliersModel>name',
                type: 'veronchi.leverx.project.utils.RequiredInputType',
                constraints: {
                  minLength: 1
                }
              }"
            />
          </VBox>
          <VBox>
            <Text text="{suppliersModel>country}" visible="{= ${suppliersModel>id} !== '0'}" />
            <ComboBox
              enabled="{= !${editModel>/isCountryBlocked}}"
              fieldGroupIds="countriesSuggestion"
              visible="{= ${editModel>/isEditMode} &amp;&amp; ${suppliersModel>id} === '0'}"
              items="{
                path: 'countriesModel>/Countries',
                templateShareable:false
              }"
              selectionChange="handleCountrySelection"
            >
              <items>
                <core:Item key="{countriesModel>id}" text="{countriesModel>name}" />
              </items>
            </ComboBox>
          </VBox>
          <VBox>
            <Text text="{= ${suppliersModel>state} ? ${suppliersModel>state} : '-'}" visible="{= ${suppliersModel>id} !== '0'}" />
            <ComboBox
              enabled="{= !${editModel>/isStateBlocked}}"
              fieldGroupIds="statesSuggestion"
              visible="{= ${editModel>/isEditMode} &amp;&amp; ${suppliersModel>id} === '0'}"
              items="{
                path: 'countriesModel>/States',
                templateShareable:false
              }"
              selectionChange="handleStateSelection"
            >
              <items>
                <core:Item key="{countriesModel>id}" text="{countriesModel>name}" />
              </items>
            </ComboBox>
          </VBox>
          <VBox>
            <Text text="{= ${suppliersModel>city} ? ${suppliersModel>city} : '-'}" visible="{= ${suppliersModel>id} !== '0'}" />
            <ComboBox
              enabled="{= !${editModel>/isCityBlocked}}"
              fieldGroupIds="citiesSuggestion"
              visible="{= ${editModel>/isEditMode} &amp;&amp; ${suppliersModel>id} === '0'}"
              selectionChange="handleCitySelection"
              items="{
                path: 'countriesModel>/Cities',
                templateShareable:false
              }"
            >
              <items>
                <core:Item key="{countriesModel>id}" text="{countriesModel>name}" />
              </items>
            </ComboBox>
          </VBox>
          <VBox>
            <Text text="{suppliersModel>street}" visible="{= ${suppliersModel>id} !== '0'}" />
            <Input
              fieldGroupIds="validateInput"
              required="true"
              change="_validateInputControl(${$source>/})"
              visible="{= ${editModel>/isEditMode} &amp;&amp; ${suppliersModel>id} === '0'}"
              value="{
                path: 'suppliersModel>street',
                type: 'veronchi.leverx.project.utils.RequiredInputType',
                constraints: {
                  minLength: 1
                }
              }"
            />
          </VBox>
          <VBox>
            <Text text="{suppliersModel>zipCode}" visible="{= ${suppliersModel>id} !== '0'}" />
            <Input
              fieldGroupIds="validateInput"
              required="true"
              change="_validateInputControl(${$source>/})"
              type="Number"
              visible="{= ${editModel>/isEditMode} &amp;&amp; ${suppliersModel>id} === '0'}"
              value="{
                path: 'suppliersModel>zipCode',
                type: 'veronchi.leverx.project.utils.RequiredInputType',
                constraints: {
                  minLength: 1,
                  minimum: 1
                }
              }"
            />
          </VBox>
        </cells>
      </ColumnListItem>
    </items>
  </Table>
</core:FragmentDefinition>